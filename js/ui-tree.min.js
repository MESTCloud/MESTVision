var UITree = function () {
    var handleSample2 = function () {
        var treeObj={};
        $('#tree_2').jstree({
        
            'plugins': [ "checkbox", "types"],
            'core': {
                "themes" : {
                    "responsive": false
                },
                'data': [{
                    "text": "Same but with checkboxes",
                    "children": [{
                        "text": "initially selected1",
                        "state": {
                            "selected": true
                        }
                    }, {
                        "text": "custom icon",
                        "icon": "fa fa-folder icon-state-warning"
                    }, {
                        "text": "initially open1",
                        "icon" : "fa fa-folder icon-state-warning",
                       "state": {
                            "opened": true
                        },
                        "children": ["Another node"]
                    }, {
                        "text": "custom icon",
                        "icon": "fa fa-folder icon-state-warning"
                    }, {
                        "text": "disabled node",
                        "icon": "fa fa-folder icon-state-warning",
                       /* "state": {
                            "opened": true
                        }*/
                    }]
                },
                    "And wholerow selection"
                ]
            },
            "types" : {
                "default" : {
                    "icon" : "fa fa-folder icon-state-warning icon-lg"
                },
                "file" : {
                    "icon" : "fa fa-file icon-state-warning icon-lg"
                }
            }
        });
        $("#tree_2").bind("activate_node.jstree", function (obj,e) {
            var currentNode = e.node;
            treeObj=currentNode;

        });
        $('#tree_2').on("click.jstree",function(e){
            console.log(treeObj);
            console.log(treeObj.id);
        });
    }
    var contextualMenuSample = function() {
      var currentNode="";
        $("#tree_3").jstree({

            "core" : {
                "themes" : {
                    "responsive": false
                },
                // so that create works
                "check_callback" : true,
                'data': [{
                    "text": "云平台",
                    "children": [{
                        "text": "Initially selected",
                        "state": {
                            "selected": true
                        }
                    }, {
                        "text": "Custom Icon",
                        "icon": "fa fa-warning icon-state-danger"
                    }, {
                        "text": "Initially open",
                        "icon" : "fa fa-folder icon-state-success",
                        "state": {
                            "opened": false

                        },
                        "children": [
                            {"text": "Another node", "icon" : "fa fa-file icon-state-warning"}
                        ]
                    }, {
                        "text": "Another Custom Icon",
                        "icon": "fa fa-warning icon-state-warning"
                    }, {
                        "text": "Disabled Node",
                        "icon": "fa fa-check icon-state-success",
                        "state": {
                            "disabled": false
                        }
                    }, {
                        "text": "Sub Nodes",
                        "icon": "fa fa-folder icon-state-danger",
                        "children": [
                            {"text": "Item 1", "icon" : "fa fa-file icon-state-warning"},
                            {"text": "Item 2", "icon" : "fa fa-file icon-state-success"},
                            {"text": "Item 3", "icon" : "fa fa-file icon-state-default"},
                            {"text": "Item 4", "icon" : "fa fa-file icon-state-danger"},
                            {"text": "Item 5", "icon" : "fa fa-file icon-state-info"}
                        ]
                    }]
                },
                    "Another Node"
                ]
            },
            "types" : {
                "default" : {
                    "icon" : "fa fa-folder icon-state-warning icon-lg"
                },
                "file" : {
                    "icon" : "fa fa-file icon-state-warning icon-lg"
                }
            },
            "state" : { "key" : "demo2" },

           "plugins" : [ "contextmenu", "dnd", "state", "types" ]
        });
        $("#tree_3").bind("activate_node.jstree", function (obj,e) {
             currentNode = e.node;

        });
        $("#tree_3").bind("click.jstree", function (event) {
            console.log(currentNode.id);
            $.ajax({
                url: "../js/json",
                type: "get",
                data: {id:currentNode.id},
                dataType: "json",
                success: function (data) {
                   /* $("tbody").html(bindTable(data));*/
                }
            });
        });

        $("#tree_3").on("dblclick.jstree",function(event,data){
             console.log(currentNode);
           $(this).prop("data-toggle", "modal");

           $('#my_Modal_tree_Add').modal('show');
            console.log(currentNode.id);
           $("#input_treeName").val(currentNode.text);
           $("#input_treeNumber").val(currentNode.id);
           $("#input_treeAddress").val("值");
           $("#save_inputTreeAdd").on("click",function(){

              if(Mark()){
                  $('#my_Modal_tree_Add').modal('hide');
              }
           });


        });
        $("#tree_3").on("move_node.jstree",function(e){

        });


    }
    function bindTable(datatable) {
        if (datatable.length > 0) {
            var str = "";
            $.each(datatable, function (index, data) {

                if (parseInt(index) / 2 == 0) {
                    str += "<tr class='gradeX odd' role='row'>"
                } else {
                    str += "<tr class='gradeX even' role='row'>"
                }
                str += " <td><label class='mt-checkbox mt-checkbox-single mt-checkbox-outline'>";
                str += "<input type='checkbox' class='checkboxes' value='" + data["id"] + "' name='check_table'>";
                str += "<span></span>";
                str += "</label> </td>";
                str += "<td class='sorting_1'>" + data["loginName"] + "</td>";
                str += "<td>" + data["name"] + "</td>";
                str += "<td>" + data["number"] + "</td>";
                str += "<td>" + data["role"] + "</td>";
                str += "<td>" + data["you"] + "</td>";
                str += "</tr>";


            });

        }

        return str;
    }
    function info(str)
    {
        $(".context_reminder").html(str);
    }
    $(".cancel").click(function(){
        $(".reminder").hide();
    });
    /*判定不能为空*/
   function Mark()
    {

        if($("#input_treeName").val().trim()=="")
        {
            UITree.info("姓名不能为空");
            $(".reminder").show();
            $("#input_treeName").focus();
            return false;
        }
        if($("#input_treeNumber").val().trim()=="")
        {
            info("编号不能为空");
            $(".reminder").show();
            $("#input_treeNumber").focus();
            return false;
        }
        if($("#input_treeAddress").val().trim()=="")
        {
            info("网址不能为空！");
            $(".reminder").show();
            $("#input_treeAddress").focus();
            return false;
        }
        if($("#input_treeDescribe").val().trim()=="")
        {
            info("请填写此节点的作用！");
            $(".reminder").show();
            $("#input_treeDescribe").focus();
            return false;

        }
        if($("#check-tree_Add").prop("checked")==false){

            info("请勾选公开项！");
            $(".reminder").show();
            return false;
        }
        return true;

    }

  /*角色菜单管理*/
  
    var RoleMenu = function () {
        var treeObj={};
        $('#tree_role').jstree({
            'plugins': [ "checkbox", "types"],
            'core': {
                "themes" : {
                    "responsive": false
                },
                'data': [{
                    "text": "能源管理系统",
                    "children": [{
                        "text": "系统管理",
                        "state": {
                            "selected": true
                        }
                    }, {
                        "text": "气体站",
                        "icon": "fa fa-folder icon-state-warning"
                    }, {
                        "text": "水泥厂",
                        "icon" : "fa fa-folder icon-state-warning",
                       "state": {
                            "opened": true
                        },
                        "children": ["DCS画面"]
                    }, {
                        "text": "智能楼宇",
                        "icon": "fa fa-folder icon-state-warning"
                    }, {
                        "text": "item 1",
                        "icon": "fa fa-folder icon-state-warning",
                       /* "state": {
                            "opened": true
                        }*/
                    }]
                },
                    /*"And wholerow selection"*/
                ]
            },
            "types" : {
                "default" : {
                    "icon" : "fa fa-folder icon-state-warning icon-lg"
                },
                "file" : {
                    "icon" : "fa fa-file icon-state-warning icon-lg"
                }
            }
        });
        $("#tree_role").bind("activate_node.jstree", function (obj,e) {
            var currentNode = e.node;
            treeObj=currentNode;

        });
         $('#tree_role').on("click.jstree",function(e){
            console.log(treeObj);
            console.log(treeObj.id);
        });
        $("#role_save").on(function(){
        	  //点击保存时，将id 保存到库中
        });
      
    }




    return {
        //main function to initiate the module
        init: function () {

            handleSample2();
            contextualMenuSample();
RoleMenu();
        }

    };

}();

if (App.isAngularJsApp() === false) {
    jQuery(document).ready(function() {
        UITree.init();
    });
}